<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marco Perrotta's site</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Ubuntu', 'Arial', sans-serif;
            /* Sfondo monocromatico grigio-blu */
            background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%);
            height: 100vh;
            overflow: hidden;
            position: relative;
        }

        .desktop {
            width: 100%;
            height: 100vh;
            position: relative;
            padding: 20px;
            /* Effetti sottili monocromatici grigio-blu */
            background-image:
                radial-gradient(circle at 20% 50%, rgba(52, 73, 94, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(44, 62, 80, 0.2) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(58, 83, 108, 0.25) 0%, transparent 50%);
        }
        .file-icon, .folder-icon, .link-icon, .mail-icon {
            position: absolute; width: 80px; height: 100px;
            cursor: pointer; transition: all 0.3s ease; user-select: none;
        }
        .file-icon:hover, .folder-icon:hover, .link-icon:hover, .mail-icon:hover { transform: scale(1.1); }
        .icon-image {
            width: 64px; height: 64px; margin: 0 auto 5px;
            background-size: contain; background-repeat: no-repeat; background-position: center;
        }
        .file-icon .icon-image {
            background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23ffffff"><path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/></svg>');
        }
        .folder-icon .icon-image {
            background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23ffd700"><path d="M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z"/></svg>');
        }
        .link-icon .icon-image {
            background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%2300aaff"><path d="M16.36,14C16.44,13.34 16.5,12.68 16.5,12C16.5,11.32 16.44,10.66 16.36,10H19.74C19.9,10.64 20,11.31 20,12C20,12.69 19.9,13.36 19.74,14M14.59,19.56C15.19,18.45 15.65,17.25 15.97,16H18.92C17.96,17.65 16.43,18.93 14.59,19.56M14.34,14H9.66C9.56,13.34 9.5,12.68 9.5,12C9.5,11.32 9.56,10.65 9.66,10H14.34C14.43,10.65 14.5,11.32 14.5,12C14.5,12.68 14.43,13.34 14.34,14M12,19.96C11.17,18.76 10.5,17.43 10.09,16H13.91C13.5,17.43 12.83,18.76 12,19.96M8,8H5.08C6.03,6.34 7.57,5.06 9.4,4.44C8.8,5.55 8.35,6.75 8,8M5.08,16H8C8.35,17.25 8.8,18.45 9.4,19.56C7.57,18.93 6.03,17.65 5.08,16M4.26,14C4.1,13.36 4,12.69 4,12C4,11.31 4.1,10.64 4.26,10H7.64C7.56,10.66 7.5,11.32 7.5,12C7.5,12.68 7.56,13.34 7.64,14M12,4.03C12.83,5.23 13.5,6.57 13.91,8H10.09C10.5,6.57 11.17,5.23 12,4.03M18.92,8H15.97C15.65,6.75 15.19,5.55 14.59,4.44C16.43,5.07 17.96,6.34 18.92,8M12,2C6.47,2 2,6.5 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"/></svg>');
            position: relative;
        }
        .mail-icon .icon-image {
            background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23ff6b6b"><path d="M20,8L12,13L4,8V6L12,11L20,6M20,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V6C22,4.89 21.11,4 20,4Z"/></svg>');
        }
        /* Piccola freccia per indicare che Ã¨ un collegamento */
        .link-icon .icon-image::after {
            content: '';
            position: absolute;
            bottom: -2px;
            right: -2px;
            width: 16px;
            height: 16px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="rgb(255,255,255)"><path d="M12,2A10,10 0 0,0 2,12C2,16.42 4.87,20.17 8.84,21.5C9.34,21.58 9.5,21.27 9.5,21C9.5,20.77 9.5,20.14 9.5,19.31C6.73,19.91 6.14,17.97 6.14,17.97C5.68,16.81 5.03,16.5 5.03,16.5C4.12,15.88 5.1,15.9 5.1,15.9C6.1,15.97 6.63,16.93 6.63,16.93C7.5,18.45 8.97,18 9.54,17.76C9.63,17.11 9.89,16.67 10.17,16.42C7.95,16.17 5.62,15.31 5.62,11.5C5.62,10.39 6,9.5 6.65,8.79C6.55,8.54 6.2,7.5 6.75,6.15C6.75,6.15 7.59,5.88 9.5,7.17C10.29,6.95 11.15,6.84 12,6.84C12.85,6.84 13.71,6.95 14.5,7.17C16.41,5.88 17.25,6.15 17.25,6.15C17.8,7.5 17.45,8.54 17.35,8.79C18,9.5 18.38,10.39 18.38,11.5C18.38,15.32 16.04,16.16 13.81,16.41C14.17,16.72 14.5,17.33 14.5,18.26C14.5,19.6 14.5,20.68 14.5,21C14.5,21.27 14.66,21.59 15.17,21.5C19.14,20.16 22,16.42 22,12A10,10 0 0,0 12,2Z"/></svg>');

            background-size: contain;
            background-repeat: no-repeat;
        }
        .icon-label {
            color: white; font-size: 12px; text-align: center;
            background: rgba(0, 0, 0, 0.6); padding: 2px 6px; border-radius: 4px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8); word-wrap: break-word;
        }
        .editor-window, .folder-window {
            position: fixed; background: #2d3748; border-radius: 8px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4); z-index: 1000;
            width: 700px; height: 500px; /* Dimensioni fisse per test */
            border: 1px solid #4a5568; display: none;
        }
        .window-header {
            background: linear-gradient(135deg, #4a5568, #2d3748); padding: 12px;
            border-radius: 8px 8px 0 0; display: flex; justify-content: space-between; align-items: center;
            cursor: move; border-bottom: 1px solid #1a202c;
            height: 50px; /* Altezza fissa */
            flex-shrink: 0;
        }
        .window-title { color: white; font-weight: bold; font-size: 14px; }
        .window-controls { display: flex; gap: 8px; }
        .control-btn {
            width: 16px; height: 16px; border-radius: 50%; cursor: pointer; transition: opacity 0.2s;
        }
        .control-btn.close { background: #ff5f56; }
        .control-btn.minimize { background: #ffbd2e; }
        .control-btn.maximize { background: #27ca3f; }
        .control-btn:hover { opacity: 0.8; }
        .editor-content {
            height: calc(100% - 50px); /* Sottrae esattamente l'altezza del header */
            display: flex;
            flex-direction: column;
        }
        .editor-toolbar {
            background: #1a202c; padding: 8px 12px; border-bottom: 1px solid #4a5568;
            font-size: 12px; color: #a0aec0;
            height: 40px; /* Altezza fissa */
            flex-shrink: 0;
            display: flex;
            align-items: center;
        }
        .editor-textarea {
            flex: 1;
            background: #1a202c; color: #e2e8f0; border: none; padding: 15px;
            font-family: 'Consolas', 'Monaco', monospace; font-size: 14px; line-height: 1.5;
            resize: none; outline: none;
            overflow-y: auto; /* Scroll verticale quando necessario */
            min-height: 0; /* Permette al flex di ridursi */
        }
        .folder-content {
            padding: 20px;
            height: calc(100% - 84px); /* Header + breadcrumb */
            overflow-y: auto;
        }
        .folder-item {
            display: flex; align-items: center; padding: 8px 12px; color: white;
            cursor: pointer; border-radius: 4px; margin-bottom: 4px; transition: background-color 0.2s;
            min-height: 36px; /* Altezza minima per dare spazio all'icona */
        }
        .folder-item:hover { background: rgba(255, 255, 255, 0.1); }
        .folder-item-icon {
            width: 24px; height: 24px; margin-right: 16px; background-size: contain;
            background-repeat: no-repeat; background-position: center;
            flex-shrink: 0; /* Impedisce alla icona di rimpicciolirsi */
            min-width: 24px; /* Larghezza minima garantita */
        }
        .breadcrumb {
            background: #2d3748; padding: 8px 12px; border-bottom: 1px solid #4a5568;
            color: #a0aec0; font-size: 12px;
            height: 36px; /* Altezza fissa */
            flex-shrink: 0;
        }
        .breadcrumb-item { color: #63b3ed; cursor: pointer; text-decoration: none; }
        .breadcrumb-item:hover { text-decoration: underline; }
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }
        .editor-window.show, .folder-window.show { display: block; animation: fadeIn 0.3s ease; }
        .taskbar {
            position: fixed; bottom: 0; left: 0; right: 0; height: 50px;
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.6));
            backdrop-filter: blur(10px); border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: flex; align-items: center; padding: 0 20px; z-index: 500;
        }
        .taskbar-item {
            background: rgba(255, 255, 255, 0.1); color: white;
            padding: 8px 16px; border-radius: 6px; margin-right: 8px; font-size: 12px;
            cursor: pointer; transition: background 0.2s;
        }
        .taskbar-item:hover { background: rgba(255, 255, 255, 0.2); }

        /* Nuove classi per icone specifiche nelle cartelle */
        .folder-item > span{margin-left:35px}

        .folder-item-icon.email-icon {
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="rgb(255,107,107)"><path d="M20,8L12,13L4,8V6L12,11L20,6M20,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V6C22,4.89 21.11,4 20,4Z"/></svg>') !important;
        }
        .folder-item-icon.linkedin-icon {
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="rgb(0,170,255)"><path d="M19 3A2 2 0 0 1 21 5V19A2 2 0 0 1 19 21H5A2 2 0 0 1 3 19V5A2 2 0 0 1 5 3H19M18.5 18.5V13.2A3.26 3.26 0 0 0 15.24 9.94C14.39 9.94 13.4 10.46 12.92 11.24V10.13H10.13V18.5H12.92V13.57C12.92 12.8 13.54 12.17 14.31 12.17A1.4 1.4 0 0 1 15.71 13.57V18.5H18.5M6.88 8.56A1.68 1.68 0 0 0 8.56 6.88C8.56 5.95 7.81 5.19 6.88 5.19S5.19 5.95 5.19 6.88A1.69 1.69 0 0 0 6.88 8.56M8.27 18.5V10.13H5.5V18.5H8.27Z"/></svg>') !important;
        }
        /* CORREZIONE: Icona file corretta nelle cartelle */
        .folder-item-icon.file-icon {
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="rgb(100,200,255)"><path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/></svg>') !important;
        }
        /* NUOVO: Icona PDF per download */
        .folder-item-icon.pdf-icon {
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="rgb(255,80,80)"><path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/><path d="M8,15H16V17H8V15M8,13H16V11H8V13M8,9H11V7H8V9Z" fill="rgb(255,255,255)"/></svg>') !important;
        }
        /* Indicatore di download */
        .folder-item.download-item::after {
            content: 'â†“';
            margin-left: auto;
            font-weight: bold;
            color: #4ade80;
            font-size: 18px;
        }
    </style>
</head>
<body>
    <div class="desktop" id="desktop">
        <!-- File esistenti -->
        <div class="file-icon" style="top: 50px; left: 100px;" data-file="readme">
            <div class="icon-image"></div>
            <div class="icon-label">README.txt</div>
        </div>
        <div class="file-icon" style="top: 200px; left: 300px;" data-file="notes">
            <div class="icon-image"></div>
            <div class="icon-label">appunti_su_di_me.txt</div>
        </div>

        <!-- Cartelle -->
        <div class="folder-icon" style="top: 300px; left: 150px;" data-folder="documenti">
            <div class="icon-image"></div>
            <div class="icon-label">AboutMe</div>
        </div>
        <div class="folder-icon" style="top: 150px; left: 700px;" data-folder="progetti">
            <div class="icon-image"></div>
            <div class="icon-label">Progetti</div>
        </div>
        <!-- Nuova cartella Pubblicazioni -->
        <div class="folder-icon" style="top: 350px; left: 600px;" data-folder="pubblicazioni">
            <div class="icon-image"></div>
            <div class="icon-label">Pubblicazioni</div>
        </div>
        <!-- Nuova cartella Contatti -->
        <div class="folder-icon" style="top: 100px; left: 500px;" data-folder="contatti">
            <div class="icon-image"></div>
            <div class="icon-label">Contatti</div>
        </div>

        <!-- NUOVO: Icona collegamento web -->
        <div class="link-icon" style="top: 450px; left: 300px;" data-link="portfolio">
            <div class="icon-image"></div>
            <div class="icon-label">Il mio Portfolio</div>
        </div>
    </div>

    <!-- Finestra Editor -->
    <div class="editor-window" id="editorWindow">
        <div class="window-header">
            <div class="window-title" id="editorTitle">Editor di Testo</div>
            <div class="window-controls">
                <div class="control-btn minimize"></div>
                <div class="control-btn maximize"></div>
                <div class="control-btn close" onclick="closeEditor()"></div>
            </div>
        </div>
        <div class="editor-content">
            <div class="editor-toolbar">
                File: <span id="currentFile">Nessun file aperto</span> | Linee: <span id="lineCount">0</span>
            </div>
            <textarea class="editor-textarea" id="editorTextarea" placeholder="Contenuto del file..."></textarea>
        </div>
    </div>

    <!-- Finestra Cartella -->
    <div class="folder-window" id="folderWindow">
        <div class="window-header">
            <div class="window-title" id="folderTitle">Esplora File</div>
            <div class="window-controls">
                <div class="control-btn minimize"></div>
                <div class="control-btn maximize"></div>
                <div class="control-btn close" onclick="closeFolder()"></div>
            </div>
        </div>
        <div class="breadcrumb" id="breadcrumb">
            <a href="#" class="breadcrumb-item" onclick="goHome()">Home</a> / <span id="currentPath">Desktop</span>
        </div>
        <div class="folder-content" id="folderContent"></div>
    </div>

    <!-- Taskbar -->
    <div class="taskbar" id="taskbar"></div>

    <script>
        // File
        const files = {
            readme: { name: "README.txt",
                            content: `ðŸ‘‹ Ciao, sono Marco Perrotta
Software Developer appassionato di tecnologia e innovazione.
Mi piace creare soluzioni eleganti per problemi complessi.
I miei principali ambiti di interesse includono il machine learning, la programmazione e l'ottimizzazione delle implementazioni.
Attualmente, collaboro con il mio team di ricerca allo sviluppo di Sole.jl, un framework di apprendimento automatico interpretabile (IML) scritto nel linguaggio di programmazione Julia. Inoltre, sono fortemente interessato agli aspetti matematici e teorici che sottendono queste discipline.`
                            } ,
            notes: { name: "appunti_su_di_me.txt", content: `Nato a Pozzuoli e cresciuto a Ferrara, ho sviluppato fin da giovane una profonda passione per l'informatica e la tecnologia.
La mia curiositÃ  per i computer, sbocciata durante l'adolescenza, si Ã¨ evoluta nel tempo in un interesse professionale per gli aspetti piÃ¹ avanzati dell'intelligenza artificiale e della programmazione.
I miei principali ambiti di interesse includono il machine learning, la programmazione e l'ottimizzazione delle implementazioni.
Attualmente, collaboro con il mio team di ricerca allo sviluppo di Sole.jl, un framework di apprendimento automatico interpretabile (IML) scritto nel linguaggio di programmazione Julia.
Inoltre, sono fortemente interessato agli aspetti matematici e teorici che sottendono queste discipline.
Questo percorso mi ha portato a specializzarmi nell'ambito del machine learning, dove posso combinare il mio amore per la matematica con le sfide dell'implementazione pratica`},
            email: { name: "email.txt", content: `ðŸ“§ Il mio indirizzo email principale:

perrottamarco2011@gmail.com

Sentiti libero di contattarmi per:
- OpportunitÃ  lavorative
- Collaborazioni su progetti
- Discussioni tecniche
- Domande sui miei progetti`}
        };

        // NUOVO: Collegamenti web
        const links = {
            portfolio: {
                name: "Il mio Portfolio",
                url: "https://github.com/Perro2110",
                target: "_blank"
            },
            linkedin: {
                name: "LinkedIn",
                url: "https://linkedin.com/in/marco-perrotta-b159b6244",
                target: "_blank"
            },
            email: {
                name: "Invia Email",
                url: "mailto:perrottamarco2011@gmail.com?subject=Contatto dal Portfolio&body=Ciao Marco,%0D%0A%0D%0AHo visto il tuo portfolio e vorrei contattarti per:%0D%0A%0D%0A",
                target: "_self"
            }
        };

        // NUOVO: Download diretti per PDF
        const downloads = {
            thesis: {
                name: "Scarica Tesi (PDF)",
                url: "https://github.com/Perro2110/perro2110.github.io/raw/main/Tesi.pdf",
                filename: "Tesi_Marco_Perrotta.pdf"
            },
            paper: {
                name: "Scarica Paper Workshop (PDF)",
                url: "https://overlay.uniud.it/workshop/2024/papers/paper14.pdf",
                filename: "Workshop_Paper_Marco_Perrotta.pdf"
            }
        };

        // Funzione helper per ottenere l'icona appropriata
        function getIconClass(linkKey) {
            switch(linkKey) {
                case 'email':
                    return 'email-icon';
                case 'linkedin':
                    return 'linkedin-icon';
                default:
                    return 'file-icon';
            }
        }

        // Cartelle
        const folders = {
            documenti: {
                name: "AboutMe",
                files: [
                    { name: "formazione.txt", content: `ðŸ“š Formazione
- UniversitÃ  degli Studi di Ferrara
    Laurea Magistrale in AI (in corso)
    Laurea Triennale in Informatica (2022-2025) - 110/110 cum laude

- IIS N.Copernico A.Carpeggiani
    Diploma in Scienze Informatiche (2017-2022) - 100/100 cum laude`},
                    { name: "competenze.txt", content: `ðŸ›  Competenze Tecniche
- C, Java, Julia, Haskell, Python
- Unix-like OS, Git
- MySQL, PHP, Laravel` }
                ]
            },
            progetti: {
                name: "Progetti",
                files: [
                    { name: "Lumen.txt", content: `Algoritmo LUMEN
Logic-driven Unified Minimal Extractor of Notions Ã¨ un algoritmo esatto e altamente parallelizzabile che, grazie alla sua elevata parametrizzazione, consente, qualora richiesto, di individuare un equilibrio ottimale tra la precisione dei risultati e la complessitÃ  computazionale.` },
                    { name: "SolePostHoc.txt", content: `Libreria SOLEPOSTHOC.jl
Libreria integrata nell'ecosistema SOLE dedicata all'implementazione di algoritmi post-hoc avanzati, con particolare enfasi sul unificazione di meccanismi di estrazione concettuale.` },
                    { name: "Sole.txt", content: `Framework SOLE.jl
Un framework per l'apprendimento automatico simbolico, trasparente e interpretabile` }
                ]
            },
            pubblicazioni: {
                name: "Pubblicazioni",
                files: [
                    { name: "tesi.txt", content: `- Tesi di Laurea Triennale â€¢ UniversitÃ  degli Studi di Ferrara
                        â€¢ Informatica â€¢ 2024
  "Un framework sistematico logic-based per spiegare modelli simbolici di
   ensemble"
    La mia tesi di laurea triennale, che approfondisce gli aspetti teorici e
    pratici del framework LUMEN per spiegare modelli simbolici di ensemble` },
                    { name: "lista_paper.txt", content: `- Workshop Paper â€¢ 2024
  "Minimal Rules from Decision Forests: a Systematic Approach"
    Analisi, formalizzazione e approccio iniziale alla risoluzione del problema
    dell'estrazione di regole minime da foreste decisionali.` }
                ],
                downloads: [
                    { name: "Tesi (Download)", key: "thesis" },
                    { name: "Minimal Rules from Decision Forests: a Systematic Approach (PDF-viewer)", key: "paper" }
                ]
            },
            contatti: {
                name: "Contatti",
                files: [],
                links: [
                    { name: "Invia Email", key: "email" },
                    { name: "LinkedIn", key: "linkedin" }
                ]
            }
        };

        let currentFolder = null;
        let openWindows = [];
        let windowZIndex = 1000;

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Aggiungi event listeners per i file
            document.querySelectorAll('.file-icon').forEach(icon => {
                icon.addEventListener('dblclick', function() {
                    const fileKey = this.getAttribute('data-file');
                    openFile(fileKey);
                });
            });

            // Aggiungi event listeners per le cartelle
            document.querySelectorAll('.folder-icon').forEach(icon => {
                icon.addEventListener('dblclick', function() {
                    const folderKey = this.getAttribute('data-folder');
                    openFolder(folderKey);
                });
            });

            // NUOVO: Aggiungi event listeners per i collegamenti
            document.querySelectorAll('.link-icon').forEach(icon => {
                icon.addEventListener('dblclick', function() {
                    const linkKey = this.getAttribute('data-link');
                    openLink(linkKey);
                });
            });

            // NUOVO: Aggiungi event listeners per le mail
            document.querySelectorAll('.mail-icon').forEach(icon => {
                icon.addEventListener('dblclick', function() {
                    const fileKey = this.getAttribute('data-file');
                    openFile(fileKey);
                });
            });

            // Rendi le finestre draggable
            makeWindowDraggable('editorWindow');
            makeWindowDraggable('folderWindow');

            // Aggiungi listener per aggiornare il contatore delle linee
            document.getElementById('editorTextarea').addEventListener('input', updateLineCount);
        });

        // NUOVO: Funzione per aprire collegamenti
        function openLink(linkKey) {
            const link = links[linkKey];
            if (!link) return;

            // Apre il link in una nuova finestra/tab
            window.open(link.url, link.target || '_blank');
        }

        // NUOVO: Funzione per scaricare file PDF
        function downloadFile(downloadKey) {
            const download = downloads[downloadKey];
            if (!download) return;

            // Crea un elemento link temporaneo per il download
            const a = document.createElement('a');
            a.href = download.url;
            a.download = download.filename;
            a.target = '_blank';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }

        function openFile(fileKey) {
            const file = files[fileKey];
            if (!file) return;

            const editorWindow = document.getElementById('editorWindow');
            const editorTitle = document.getElementById('editorTitle');
            const editorTextarea = document.getElementById('editorTextarea');
            const currentFile = document.getElementById('currentFile');

            editorTitle.textContent = `Editor - ${file.name}`;
            currentFile.textContent = file.name;
            editorTextarea.value = file.content;

            // Posiziona la finestra al centro con dimensioni fisse
            editorWindow.style.left = `${(window.innerWidth - 700) / 2 + Math.random() * 50 - 25}px`;
            editorWindow.style.top = `${(window.innerHeight - 500) / 2 + Math.random() * 50 - 25}px`;
            editorWindow.style.zIndex = ++windowZIndex;

            editorWindow.classList.add('show');
            updateLineCount();
            addToTaskbar(`Editor - ${file.name}`, 'editor');
        }

        function openFolder(folderKey) {
            const folder = folders[folderKey];
            if (!folder) return;

            currentFolder = folderKey;
            const folderWindow = document.getElementById('folderWindow');
            const folderTitle = document.getElementById('folderTitle');
            const folderContent = document.getElementById('folderContent');
            const currentPath = document.getElementById('currentPath');

            folderTitle.textContent = folder.name;
            currentPath.textContent = folder.name;

            // Genera il contenuto della cartella
            folderContent.innerHTML = '';

            // Aggiungi i file normali
            folder.files.forEach((file, index) => {
                const fileElement = document.createElement('div');
                fileElement.className = 'folder-item';
                fileElement.innerHTML = `
                    <div class="folder-item-icon file-icon"></div>
                    <span>${file.name}</span>
                `;
                fileElement.addEventListener('dblclick', () => {
                    openFileFromFolder(folderKey, index);
                });
                folderContent.appendChild(fileElement);
            });

            // Aggiungi i collegamenti se presenti
            if (folder.links) {
                folder.links.forEach((link) => {
                    const linkElement = document.createElement('div');
                    linkElement.className = 'folder-item';

                    const iconClass = getIconClass(link.key);
                    linkElement.innerHTML = `
                        <div class="folder-item-icon ${iconClass}"></div>
                        <span>${link.name}</span>
                    `;
                    linkElement.addEventListener('dblclick', () => {
                        openLink(link.key);
                    });
                    folderContent.appendChild(linkElement);
                });
            }

            // NUOVO: Aggiungi i download PDF se presenti
            if (folder.downloads) {
                folder.downloads.forEach((download) => {
                    const downloadElement = document.createElement('div');
                    downloadElement.className = 'folder-item download-item';
                    downloadElement.innerHTML = `
                        <div class="folder-item-icon pdf-icon"></div>
                        <span>${download.name}</span>
                    `;
                    downloadElement.addEventListener('dblclick', () => {
                        downloadFile(download.key);
                    });
                    folderContent.appendChild(downloadElement);
                });
            }

            // Posiziona la finestra
            folderWindow.style.left = `${(window.innerWidth - 700) / 2 + Math.random() * 100 - 50}px`;
            folderWindow.style.top = `${(window.innerHeight - 500) / 2 + Math.random() * 100 - 50}px`;
            folderWindow.style.zIndex = ++windowZIndex;

            folderWindow.classList.add('show');
            addToTaskbar(folder.name, 'folder');
        }

        function openFileFromFolder(folderKey, fileIndex) {
            const folder = folders[folderKey];
            const file = folder.files[fileIndex];

            const editorWindow = document.getElementById('editorWindow');
            const editorTitle = document.getElementById('editorTitle');
            const editorTextarea = document.getElementById('editorTextarea');
            const currentFile = document.getElementById('currentFile');

            editorTitle.textContent = `Editor - ${file.name}`;
            currentFile.textContent = `${folder.name}/${file.name}`;
            editorTextarea.value = file.content;

            editorWindow.style.left = `${(window.innerWidth - 700) / 2 + Math.random() * 50 - 25}px`;
            editorWindow.style.top = `${(window.innerHeight - 500) / 2 + Math.random() * 50 - 25}px`;
            editorWindow.style.zIndex = ++windowZIndex;

            editorWindow.classList.add('show');
            updateLineCount();
            addToTaskbar(`Editor - ${file.name}`, 'editor');
        }

        function closeEditor() {
            document.getElementById('editorWindow').classList.remove('show');
            removeFromTaskbar('editor');
        }

        function closeFolder() {
            document.getElementById('folderWindow').classList.remove('show');
            removeFromTaskbar('folder');
        }

        function goHome() {
            // Implementazione per tornare al desktop
            closeFolder();
        }

        function updateLineCount() {
            const textarea = document.getElementById('editorTextarea');
            const lineCount = textarea.value.split('\n').length;
            document.getElementById('lineCount').textContent = lineCount;
        }

        function addToTaskbar(title, type) {
            const taskbar = document.getElementById('taskbar');
            const taskbarItem = document.createElement('div');
            taskbarItem.className = 'taskbar-item';
            taskbarItem.textContent = title;
            taskbarItem.dataset.type = type;
            taskbarItem.addEventListener('click', () => {
                if (type === 'editor') {
                    document.getElementById('editorWindow').style.zIndex = ++windowZIndex;
                } else if (type === 'folder') {
                    document.getElementById('folderWindow').style.zIndex = ++windowZIndex;
                }
            });
            taskbar.appendChild(taskbarItem);
        }

        function removeFromTaskbar(type) {
            const taskbar = document.getElementById('taskbar');
            const items = taskbar.querySelectorAll(`.taskbar-item[data-type="${type}"]`);
            items.forEach(item => item.remove());
        }

        function makeWindowDraggable(windowId) {
            const window = document.getElementById(windowId);
            const header = window.querySelector('.window-header');
            let isDragging = false;
            let currentX = 0;
            let currentY = 0;
            let initialX = 0;
            let initialY = 0;

            header.addEventListener('mousedown', dragStart);
            document.addEventListener('mousemove', drag);
            document.addEventListener('mouseup', dragEnd);

            function dragStart(e) {
                initialX = e.clientX - window.offsetLeft;
                initialY = e.clientY - window.offsetTop;
                isDragging = true;
                window.style.zIndex = ++windowZIndex;
            }

            function drag(e) {
                if (isDragging) {
                    e.preventDefault();
                    currentX = e.clientX - initialX;
                    currentY = e.clientY - initialY;

                    window.style.left = currentX + 'px';
                    window.style.top = currentY + 'px';
                }
            }

            function dragEnd() {
                isDragging = false;
            }
        }

        // Gestione del click sulle finestre per portarle in primo piano
        document.addEventListener('click', function(e) {
            if (e.target.closest('#editorWindow')) {
                document.getElementById('editorWindow').style.zIndex = ++windowZIndex;
            } else if (e.target.closest('#folderWindow')) {
                document.getElementById('folderWindow').style.zIndex = ++windowZIndex;
            }
        });
    </script>
</body>
</html>